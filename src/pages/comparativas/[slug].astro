---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { COMPARATIVAS } from "../../data/comparativas";

export async function getStaticPaths() {
  return COMPARATIVAS.map((c) => ({ params: { slug: c.slug } }));
}

const { slug } = Astro.params;
const c = COMPARATIVAS.find((x) => x.slug === slug);
if (!c) throw new Error(`Comparativa nao encontrada: ${slug}`);

const title = c.title;
const description = c.description;

const url = `https://novaraiz.netlify.app/comparativas/${c.slug}/`;

const A = c.a;
const B = c.b;

const fmt = (v) => (v && String(v).trim().length ? String(v) : "—");

const breadcrumbJsonLd = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: [
    { "@type": "ListItem", position: 1, name: "Home", item: "https://novaraiz.netlify.app/" },
    { "@type": "ListItem", position: 2, name: "Comparativas", item: "https://novaraiz.netlify.app/comparativas/" },
    { "@type": "ListItem", position: 3, name: `${A.name} vs ${B.name}`, item: url },
  ],
};

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: [
    {
      "@type": "Question",
      name: `Como decidir entre ${A.name} e ${B.name} sem romantizar a mudanca?`,
      acceptedAnswer: {
        "@type": "Answer",
        text: "Use custo total + bairro + internet + saude/educacao como pilares. Em 7 dias voce valida rotas, estabilidade de internet e rotina real com visita-teste.",
      },
    },
    {
      "@type": "Question",
      name: "O que pesa mais: cidade, bairro ou estilo de vida?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "O bairro normalmente define a experiencia (deslocamento, seguranca percebida, servicos e internet). A cidade define escala e variedade. O estilo de vida define sua tolerancia a transito e dependencia de carro.",
      },
    },
    {
      "@type": "Question",
      name: "Como validar internet antes de fechar contrato?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "Teste no imovel em horarios diferentes, confirme fibra na rua/condominio, cheque operadoras e tenha plano B (coworking + 5G).",
      },
    },
  ],
};

const articleJsonLd = {
  "@context": "https://schema.org",
  "@type": "Article",
  headline: title,
  description,
  dateModified: c.updated,
  mainEntityOfPage: url,
  publisher: { "@type": "Organization", name: "Nova Raiz" },
};
---

<BaseLayout title={title} description={description}>
  <section class="py-10 md:py-14">
    <div class="mx-auto max-w-4xl">
      <nav class="text-xs" style="color: var(--muted);">
        <a class="underline" href="/">Home</a>
        <span class="mx-2">/</span>
        <a class="underline" href="/comparativas/">Comparativas</a>
        <span class="mx-2">/</span>
        <span>{A.name} vs {B.name}</span>
      </nav>

      <h1 class="mt-4 text-4xl md:text-5xl" style="font-family:'Playfair Display', serif;">
        {A.name} vs {B.name} (2026)
      </h1>
      <p class="mt-3 text-lg" style="color: var(--muted);">{description}</p>

      <div class="mt-2">
        <script type="application/ld+json" set:html={JSON.stringify(breadcrumbJsonLd)}></script>
        <script type="application/ld+json" set:html={JSON.stringify(faqJsonLd)}></script>
        <script type="application/ld+json" set:html={JSON.stringify(articleJsonLd)}></script>
      </div>

      <div class="mt-6 grid gap-4 md:grid-cols-3">
        <div class="rounded-3xl border p-5 md:col-span-2" style="border-color: var(--border); background: var(--card);">
          <div class="text-sm font-semibold">Resumo executivo</div>
          <p class="mt-2 text-sm" style="color: var(--muted);">
            Para trabalho remoto, a decisao costuma ser: <b>internet confiavel</b> + <b>bairro certo</b> + <b>rotina simples</b>.
            Para trabalho local, <b>escala</b> e <b>setores fortes</b> pesam mais — e normalmente encarecem o custo total.
          </p>
        </div>

        <div class="rounded-3xl border p-5" style="border-color: var(--border); background: var(--surface);">
          <div class="text-xs" style="color: var(--muted);">Atualizado</div>
          <div class="text-sm font-semibold">{c.updated}</div>
          <div class="mt-4 text-sm"><a class="underline" href="/comparador/">Comparar outras cidades</a></div>
          <div class="mt-2 text-sm"><a class="underline" href="/checklist/">Checklist da mudanca</a></div>
        </div>
      </div>

      <div class="mt-10 space-y-10">
        <div class="rounded-3xl border p-6" style="border-color: var(--border); background: var(--card);">
          <h2 class="text-2xl font-semibold">Tabela comparativa</h2>
          <p class="mt-2 text-sm" style="color: var(--muted);">
            Campos prontos para dados oficiais. Onde nao houver dado, aparece "—".
          </p>
          <div class="mt-4 overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr style="color: var(--muted);">
                  <th class="py-2 text-left">Indicador</th>
                  <th class="py-2 text-left">{A.name}</th>
                  <th class="py-2 text-left">{B.name}</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">IDH</td><td class="py-2" style="color: var(--muted);">{fmt(A.idh)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.idh)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Populacao</td><td class="py-2" style="color: var(--muted);">{fmt(A.pop)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.pop)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">PIB per capita</td><td class="py-2" style="color: var(--muted);">{fmt(A.pib_per_capita)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.pib_per_capita)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Renda media mensal</td><td class="py-2" style="color: var(--muted);">{fmt(A.renda_media)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.renda_media)}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="rounded-3xl border p-6" style="border-color: var(--border); background: var(--surface);">
          <h2 class="text-2xl font-semibold">Leia tambem</h2>
          <ul class="mt-3 list-disc pl-5 text-sm space-y-2" style="color: var(--muted);">
            <li><a class="underline" href="/mudar-para-o-interior-guia-definitivo/">Guia definitivo da mudanca</a></li>
            <li><a class="underline" href="/checklist/">Checklist completo</a></li>
            <li><a class="underline" href="/blog/melhores-cidades-interior-brasil-2026/">Guia Mestre (Brasil)</a></li>
          </ul>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
