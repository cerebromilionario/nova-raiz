---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { COMPARATIVAS } from "../../data/comparativas";

export async function getStaticPaths() {
  return COMPARATIVAS.map((c) => ({ params: { slug: c.slug } }));
}

const { slug } = Astro.params;
const c = COMPARATIVAS.find((x) => x.slug === slug);
if (!c) throw new Error(`Comparativa não encontrada: ${slug}`);

const title = c.title;
const description = c.description;

const url = `https://novaraiz.netlify.app/comparativas/${c.slug}/`;

const A = c.a;
const B = c.b;

const fmt = (v) => (v && String(v).trim().length ? String(v) : "—");

const breadcrumbJsonLd = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: [
    { "@type": "ListItem", position: 1, name: "Home", item: "https://novaraiz.netlify.app/" },
    { "@type": "ListItem", position: 2, name: "Comparativas", item: "https://novaraiz.netlify.app/comparativas/" },
    { "@type": "ListItem", position: 3, name: `${A.name} vs ${B.name}`, item: url },
  ],
};

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: [
    {
      "@type": "Question",
      name: `Como decidir entre ${A.name} e ${B.name} sem romantizar a mudança?`,
      acceptedAnswer: {
        "@type": "Answer",
        text: "Use custo total + bairro + internet + saúde/educação como pilares. Em 7 dias você valida rotas, estabilidade de internet e rotina real com visita-teste.",
      },
    },
    {
      "@type": "Question",
      name: "O que pesa mais: cidade, bairro ou estilo de vida?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "O bairro normalmente define a experiência (deslocamento, sensação de segurança, serviços e internet). A cidade define escala e variedade. O estilo de vida define sua tolerância a trânsito e dependência de carro.",
      },
    },
    {
      "@type": "Question",
      name: "Como validar internet antes de fechar contrato?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "Teste no imóvel em horários diferentes, confirme fibra na rua/condomínio, cheque operadoras e tenha plano B (coworking + 5G).",
      },
    },
  ],
};

const howToJsonLd = {
  "@context": "https://schema.org",
  "@type": "HowTo",
  name: `Como escolher entre ${A.name} e ${B.name} em 7 dias (método Nova Raiz)`,
  step: [
    { "@type": "HowToStep", name: "Defina não-negociáveis", text: "Ex.: internet estável, hospital em até 20 min, parque em 10–15 min." },
    { "@type": "HowToStep", name: "Escolha 2 bairros por cidade", text: "Um para vida a pé e outro para condomínios/expansão." },
    { "@type": "HowToStep", name: "Simule custo total", text: "Moradia + condomínio + deslocamento + saúde + educação + carro." },
    { "@type": "HowToStep", name: "Faça visita-teste", text: "Teste rotas no pico, barulho à noite e internet no imóvel." },
    { "@type": "HowToStep", name: "Converse com moradores", text: "Síndico/porteiro + comerciante local." },
    { "@type": "HowToStep", name: "Valide plano B", text: "Coworking + 5G + rede de apoio." },
    { "@type": "HowToStep", name: "Decida", text: "Escolha a cidade que sustenta sua rotina com menos fricção." },
  ],
};

const articleJsonLd = {
  "@context": "https://schema.org",
  "@type": "Article",
  headline: title,
  description,
  dateModified: c.updated,
  mainEntityOfPage: url,
  publisher: { "@type": "Organization", name: "Nova Raiz" },
};
---

<BaseLayout title={title} description={description}>
  <section class="py-10 md:py-14">
    <div class="mx-auto max-w-4xl">
      <nav class="text-xs" style="color: var(--muted);">
        <a class="underline" href="/">Home</a>
        <span class="mx-2">/</span>
        <a class="underline" href="/comparativas/">Comparativas</a>
        <span class="mx-2">/</span>
        <span>{A.name} vs {B.name}</span>
      </nav>

      <h1 class="mt-4 text-4xl md:text-5xl" style="font-family:'Playfair Display', serif;">{A.name} vs {B.name} (2026)</h1>
      <p class="mt-3 text-lg" style="color: var(--muted);">{description}</p>

      <div class="mt-2">
        <script type="application/ld+json" set:html={JSON.stringify(breadcrumbJsonLd)}></script>
        <script type="application/ld+json" set:html={JSON.stringify(faqJsonLd)}></script>
        <script type="application/ld+json" set:html={JSON.stringify(howToJsonLd)}></script>
        <script type="application/ld+json" set:html={JSON.stringify(articleJsonLd)}></script>
      </div>

      <div class="mt-6 grid gap-4 md:grid-cols-3">
        <div class="rounded-3xl border p-5 md:col-span-2" style="border-color: var(--border); background: var(--card);">
          <div class="text-sm font-semibold">Resumo executivo</div>
          <p class="mt-2 text-sm" style="color: var(--muted);">
            Para trabalho remoto, a decisão costuma ser: <b>internet confiável</b> + <b>bairro certo</b> + <b>rotina simples</b>.
            Para trabalho local, <b>escala</b> e <b>setores fortes</b> pesam mais — e normalmente encarecem o custo total.
          </p>
        </div>

        <div class="rounded-3xl border p-5" style="border-color: var(--border); background: var(--surface);">
          <div class="text-xs" style="color: var(--muted);">Atualizado</div>
          <div class="text-sm font-semibold">{c.updated}</div>
          <div class="mt-4 text-sm"><a class="underline" href="/comparador/">Comparar outras cidades</a></div>
          <div class="mt-2 text-sm"><a class="underline" href="/checklist/">Checklist da mudança</a></div>
        </div>
      </div>

      <div class="mt-10 space-y-10">
        <div class="rounded-3xl border p-6" style="border-color: var(--border); background: var(--card);">
          <h2 class="text-2xl font-semibold">Tabela comparativa</h2>
          <p class="mt-2 text-sm" style="color: var(--muted);">
            Campos prontos para dados oficiais (IBGE/Atlas/INEP/DATASUS/SSP/ANATEL). Onde ainda não houver dado, aparece “—”.
          </p>

          <div class="mt-4 overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr style="color: var(--muted);">
                  <th class="py-2 text-left">Indicador</th>
                  <th class="py-2 text-left">{A.name}</th>
                  <th class="py-2 text-left">{B.name}</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">IDH</td><td class="py-2" style="color: var(--muted);">{fmt(A.idh)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.idh)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">População</td><td class="py-2" style="color: var(--muted);">{fmt(A.pop)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.pop)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">PIB per capita</td><td class="py-2" style="color: var(--muted);">{fmt(A.pib_per_capita)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.pib_per_capita)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Renda média mensal</td><td class="py-2" style="color: var(--muted);">{fmt(A.renda_media)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.renda_media)}</td>
                </tr>

                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Homicídios (por 100k)</td><td class="py-2" style="color: var(--muted);">{fmt(A.criminalidade?.homicidios_100k)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.criminalidade?.homicidios_100k)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Roubos (por 100k)</td><td class="py-2" style="color: var(--muted);">{fmt(A.criminalidade?.roubo_100k)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.criminalidade?.roubo_100k)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Furtos (por 100k)</td><td class="py-2" style="color: var(--muted);">{fmt(A.criminalidade?.furto_100k)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.criminalidade?.furto_100k)}</td>
                </tr>

                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Leitos (por 1.000)</td><td class="py-2" style="color: var(--muted);">{fmt(A.saude?.leitos_1000)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.saude?.leitos_1000)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">UBS (por 100k)</td><td class="py-2" style="color: var(--muted);">{fmt(A.saude?.ubs_100k)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.saude?.ubs_100k)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">IDEB (referência)</td><td class="py-2" style="color: var(--muted);">{fmt(A.educacao?.ideb)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.educacao?.ideb)}</td>
                </tr>

                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Fibra (cobertura)</td><td class="py-2" style="color: var(--muted);">{fmt(A.internet?.fibra_cobertura)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.internet?.fibra_cobertura)}</td>
                </tr>
                <tr class="border-t" style="border-color: var(--border);">
                  <td class="py-2">Velocidade média</td><td class="py-2" style="color: var(--muted);">{fmt(A.internet?.vel_media)}</td><td class="py-2" style="color: var(--muted);">{fmt(B.internet?.vel_media)}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="rounded-3xl border p-6" style="border-color: var(--border); background: var(--surface);">
          <h2 class="text-2xl font-semibold">Leia também</h2>
          <ul class="mt-3 list-disc pl-5 text-sm space-y-2" style="color: var(--muted);">
            <li><a class="underline" href="/mudar-para-o-interior-guia-definitivo/">Guia definitivo da mudança</a></li>
            <li><a class="underline" href="/checklist/">Checklist completo</a></li>
            <li><a class="underline" href="/blog/melhores-cidades-interior-brasil-2026/">Guia Mestre (Brasil)</a></li>
          </ul>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
